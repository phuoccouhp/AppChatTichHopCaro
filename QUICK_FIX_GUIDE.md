# ?? ?????? - Client Server ????

## ????

```
???Client ???? Server ????
???????????????????                    ???????????????????
?     Client      ?  ???????  ?       ?    Server       ?
?                 ?  ????? ? Timeout   ?                 ?
???????????????????                    ???????????????????
```

**??**: Windows Firewall ?? Outbound ??

---

## ???? - 3 ?????

### ? ???????

```bash
# ?????
QuickStart.bat

# ??? ? ??...
# ???????CMD ? PowerShell?

# ?????
# ? ?? Admin ??
# ? ?? Inbound ??
# ? ?? Outbound ??
# ? ?? Server

# ???? Client ?? ? ??!
```

### ??????????

```bash
# 1. ?? OpenFirewall.bat ? ????????
# 2. ?? Server
cd ChatAppServer
dotnet run
# 3. Client ?? ? ??!
```

### ????PowerShell ??

```powershell
# ? Admin ???? PowerShell????

# ?????
Remove-NetFirewallRule -DisplayName "ChatAppServer" -ErrorAction SilentlyContinue
Remove-NetFirewallRule -DisplayName "ChatAppServer (Out)" -ErrorAction SilentlyContinue

# ?? Inbound
New-NetFirewallRule -DisplayName "ChatAppServer" `
    -Direction Inbound -Action Allow -Protocol TCP `
    -LocalPort 9000 -Profile Domain,Private,Public -Enabled $true

# ?? Outbound (??!)
New-NetFirewallRule -DisplayName "ChatAppServer (Out)" `
    -Direction Outbound -Action Allow -Protocol TCP `
    -LocalPort 9000 -RemoteAddress Any `
    -Profile Domain,Private,Public -Enabled $true

# ??
Get-NetFirewallRule -DisplayName "ChatAppServer*" | Format-Table
```

---

## ????

### ??????????

| ?? | ?? | ?? |
|------|------|------|
| **Inbound** | ?? | ?? Client ???? |
| **Outbound** | ?? | **?? Server ????** ? ?????? |

### Outbound ???????

```
RemoteAddress = Any  ? ??????
```

- ? ?????? IP ? ?????? Client ??
- ? ??? `Any` ? ????? Client

---

## ????????

### ??? ?
```
[CONNECT] New client connected: 192.168.x.x
[RECV RAW] {"Type":"LoginPacket",...}
[Client] ????...
[?? 10 ?]
[Client] Timeout! Server ????
```

### ??? ?
```
? Firewall port 9000 successfully opened and verified!
[CONNECT] New client connected: 192.168.x.x
[RECV RAW] {"Type":"LoginPacket",...}
[LoginHandler] ??????
[SendPacket] ?? LoginResultPacket ?
[Client] ?????? ? ????!
```

---

## ??????

### ????????

```powershell
# PowerShell (Admin) ????
Get-NetFirewallRule -DisplayName "ChatAppServer*" | 
    Select DisplayName, Direction, Action, Enabled | 
    Format-Table
```

?????
```
DisplayName           Direction Action Enabled
???????????????????? ????????? ?????? ???????
ChatAppServer        Inbound   Allow  True   ?
ChatAppServer (Out)  Outbound  Allow  True   ?
```

### ?? Server ????

????????
```
? Firewall port 9000 successfully opened and verified!
Server ?????: 9000
```

### ?? Client ??

```
1. Server IP: 127.0.0.1 (??? IP)
2. Port: 9000
3. User: admin
4. Pass: 123456
5. ???? ? ????????????
```

---

## ???????

| ?? | ?? |
|------|------|
| `QuickStart.bat` | ???????? |
| `RunServerAsAdmin.bat` | Admin ?? Server |
| `OpenFirewall.bat` | ??????? |
| `CLIENT_SERVER_CONNECTION_FIX.md` | ???? |
| `SERVER_FIREWALL_SETUP_GUIDE.md` | ??????? |
| `VISUAL_GUIDE.txt` | ASCII ????? |
| `FIX_COMPLETE_SUMMARY.md` | ???? |

---

## ????

1. **Server ??? Admin ????** ? ?????????
2. **??????** ? Inbound (??) + Outbound (??)
3. **Outbound ? RemoteAddress = Any** ? ??????????
4. **???????????** ? ????????

---

## ????

### Q: "PowerShell exit code: 1" ??????

**A**: PowerShell ???????????????
- ? `QuickStart.bat` ???????
- ????? PowerShell ? ????????

### Q: ???????????????

**A**: ???
```powershell
# 1. ????????
Get-NetFirewallRule -DisplayName "ChatAppServer (Out)"

# 2. RemoteAddress ??? Any
Get-NetFirewallRule -DisplayName "ChatAppServer (Out)" | 
    Get-NetFirewallAddressFilter
```

### Q: ??? netsh ?? PowerShell ??

**A**: ???? netsh ?????????????????
???? PowerShell?New-NetFirewallRule????? `QuickStart.bat`?

---

## ????

?????????????

```bash
# ?? 1????
QuickStart.bat

# ?? 2
dotnet run --project ChatAppServer/ChatAppServer.csproj

# ?? 3????
cd ChatAppServer && dotnet run
```

Server ??????????????

---

## ??????

???????????????????

```bash
# ??????
.\DebugFirewallRules.ps1

# ????????
.\CheckFirewallRuleDetails.bat

# ???????
.\OpenFirewall.bat
```

---

## ??

**?????? `QuickStart.bat`??????????** ?

??????
- ? Client ???
- ? ??????  
- ? ??????
- ? ???????

